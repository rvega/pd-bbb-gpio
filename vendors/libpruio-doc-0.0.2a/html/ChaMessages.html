<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>libpruio: Messages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="pruio.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="pruio_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">libpruio
   &#160;<span id="projectnumber">0.0.2</span>
   </div>
   <div id="projectbrief">AM33xx-PRU driver for digital input / output and analog input</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ChaMessages.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Messages </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#SecPruState">PRU States  </a></li>
<li class="level1"><a href="#SecErrors">Error Messages  </a><ul><li class="level2"><a href="#SubErrCtor">Constructor Errors  </a></li>
<li class="level2"><a href="#SubErrConfig">config Errors  </a></li>
<li class="level2"><a href="#SubErrSet">gpio_set Errors  </a></li>
<li class="level2"><a href="#SubErrGet">gpio_get Error  </a></li>
<li class="level2"><a href="#SubErrOut">gpio_out Errors  </a></li>
<li class="level2"><a href="#SubErrGetConf">gpio_get_config Error  </a></li>
<li class="level2"><a href="#SubErrStep">adc_step Errors  </a></li>
<li class="level2"><a href="#SubErrPin">mm_trg_pin Errors  </a></li>
<li class="level2"><a href="#SubErrAin">mm_trg_ain Errors  </a></li>
<li class="level2"><a href="#SubErrPre">mm_trg_pre Errors  </a></li>
<li class="level2"><a href="#SubErrStart">mm_start Errors  </a></li>
<li class="level2"><a href="#SubErrDtor">Destructor Errors  </a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>There are three instances for sharing messages</p>
<p>user &lt;&ndash;&gt; libpruio &lt;&ndash;&gt; PRU software</p>
<p>Communication between user and libpruio is necessary in case of problems (errors). This gets done by passing human readable strings. Informations from the PRU (ie. its current state) are decoded as a binary number.</p>
<h1><a class="anchor" id="SecPruState"></a>
PRU States  </h1>
<p>The software on the PRU subsystem writes a code for its current state to <a class="el" href="structPruIo.html#af1f15a5012917afe710e259f3050695c">PruIo::DRam</a>[0]. The user can read this information and compare it with the macros defined in file pruio.hp:</p>
<table class="doxtable">
<tr>
<th align="right">Message </th><th align="center">Value </th><th align="center">Mode </th><th align="left">Meaning  </th></tr>
<tr>
<td align="right">PRUIO_MSG_INIT_OK </td><td align="center">4294967295 </td><td align="center">CTOR </td><td align="left">init successfully done </td></tr>
<tr>
<td align="right">PRUIO_MSG_EXIT_OK </td><td align="center">4294967294 </td><td align="center">DTOR </td><td align="left">exit successfully done </td></tr>
<tr>
<td align="right">PRUIO_MSG_ADC_ERRR </td><td align="center">4294967293 </td><td align="center">config </td><td align="left">ADC device not ready </td></tr>
<tr>
<td align="right">PRUIO_MSG_IO_OK </td><td align="center">4294967292 </td><td align="center">IO </td><td align="left">running in IO mode </td></tr>
<tr>
<td align="right">PRUIO_MSG_MM_WAIT </td><td align="center">4294967291 </td><td align="center">MM </td><td align="left">waiting for mm_start call </td></tr>
<tr>
<td align="right">PRUIO_MSG_MM_TRG1 </td><td align="center">4294967290 </td><td align="center">MM </td><td align="left">waiting for trigger 1 </td></tr>
<tr>
<td align="right">PRUIO_MSG_MM_TRG2 </td><td align="center">4294967289 </td><td align="center">MM </td><td align="left">waiting for trigger 2 </td></tr>
<tr>
<td align="right">PRUIO_MSG_MM_TRG3 </td><td align="center">4294967288 </td><td align="center">MM </td><td align="left">waiting for trigger 3 </td></tr>
<tr>
<td align="right">PRUIO_MSG_MM_TRG4 </td><td align="center">4294967287 </td><td align="center">MM </td><td align="left">waiting for trigger 4 </td></tr>
<tr>
<td align="right">Fetching sample </td><td align="center">0 to Samp </td><td align="center">MM </td><td align="left">executing measurement </td></tr>
</table>
<p>In MM mode the PRU software reports the currently used pointer to store a sample. This is the offset in the <a class="el" href="structPruIo.html#a4cad5c6b737eba76bb6ddd764cb763d2">PruIo::ERam</a> aray. Its maximum value is <a class="el" href="structPruIo.html#a0672d256d6dbe239b9da31d0d42d1c20">PruIo::Samples</a> * <a class="el" href="structPruIo.html#a46aea553763f9dd05ab79421bc456c5d">PruIo::ChAz</a> <code>SHL 1</code> and the amount of finished measurement in percent is <a class="el" href="structPruIo.html#af1f15a5012917afe710e259f3050695c">PruIo::DRam</a>[0] / <a class="el" href="structPruIo.html#a0672d256d6dbe239b9da31d0d42d1c20">PruIo::Samples</a> / <a class="el" href="structPruIo.html#a46aea553763f9dd05ab79421bc456c5d">PruIo::ChAz</a> <code>/ 2 * 100 %</code> .</p>
<p>When performing a pre-trigger, the value counts in the area of the pre-trigger values (the ring buffer). It starts at zero and counts upwards. When the upper border of the buffer is reached, it resets to zero and counts upwards again, unless the trigger event happens. Then it jumps to the real sample offset and counts in a continuous manner to the end of the measurement.</p>
<h1><a class="anchor" id="SecErrors"></a>
Error Messages  </h1>
<p>All member functions of the PruIo class provide error messages in case of a problem. Functions without return value (procedure type) return the error message directly (or zero on success). For other functions the error message can get accessed in the member variable <a class="el" href="structPruIo.html#a04215cd3faee95feac7af13ebeee0698">PruIo::Errr</a>. These are functions <a class="el" href="structPruIo.html#ab30acd999ad5f7f2901a08ffc06a8ba4">PruIo::gpio_get()</a>, <a class="el" href="structPruIo.html#a29f45a3f5ac52e623f84a625fcc1c4f7">PruIo::mm_trg_pin()</a>, <a class="el" href="structPruIo.html#ac0d2fd42e59f21cb06ff8d3064dc8e42">PruIo::mm_trg_ain()</a>, <a class="el" href="structPruIo.html#a966c76b10c14183e9102d3fcefe97a46">PruIo::mm_trg_pre()</a> and the constructor. The function <a class="el" href="structPruIo.html#a9abb7f95952db7da67be1fccef7a881c">PruIo::gpio_get_config()</a> returns either the error message or the configuration text.</p>
<p>Furthermore the member variable <a class="el" href="structPruIo.html#a04215cd3faee95feac7af13ebeee0698">PruIo::Errr</a> allways contain the error message (even when the function returns the error message directly). Error messages are internal (hard-coded) strings and must not be freed. libpruio does not reset the value, it gets holded until the next error occurs. So its up to the user to reset the pointer to zero when done with the message, to avoid unintended error positives for old errors.</p>
<dl class="section note"><dt>Note</dt><dd>The destructor reports errors directly to the systems ERROUT pipe (since it can't use <a class="el" href="structPruIo.html#a04215cd3faee95feac7af13ebeee0698">PruIo::Errr</a> member variable any more).</dd></dl>
<p>Here're all fuctions and their error messages, listed with the reason for the problem and a hint how to solve it.</p>
<h2><a class="anchor" id="SubErrCtor"></a>
Constructor Errors  </h2>
<ul>
<li><b>unknown PRUSS - select 0 or 1</b>: A wrong PRU number was passed -&gt; select either 0 or 1 in the last parameter <em>Pru</em>.</li>
<li><b>failed opening uio5 interrupt</b>: The interrupt to send messages from the PRU to the host couldn't get opened -&gt; check the kernel driver and its configuration.</li>
<li><b>failed loading Pru_Init instructions</b>: The driver couldn't load the instructions for the initialization to the PRU subsystem -&gt; test function of prussdrv library.</li>
<li><b>failed executing Pru_Init instructions</b>: Executing the initialization instructions failed -&gt; check if other software uses this PRU.</li>
<li><b>failed starting ADC</b>: The ADC device doesn't report a valid REVISION information -&gt; ADC device may be broken.</li>
<li><b>out of memory</b>: The driver couldn't allocate memory to store the original configuration of the divices -&gt; make sure to have at least 1 kByte of additional memory.</li>
</ul>
<h2><a class="anchor" id="SubErrConfig"></a>
config Errors  </h2>
<ul>
<li><b>no step active</b>: All step bits in the mask are zero -&gt; set at least one step active, even if you don't need ADC values.</li>
<li><b>out of memory</b>: The requested sample number needs more memory than available in the external memory block -&gt; reduce parameter <em>Samp</em> or increase the size of the external memory. (See <a class="el" href="ChaMemory.html">Memory Organisation</a> for details).</li>
<li><b>sample rate too big</b>: The ADC device needs more time to run through all active steps than available -&gt; increase parameter <em>Tmr</em>.</li>
<li><b>failed loading parameters</b>: The parameters for the driver couldn't get uploaded -&gt; check libprussdrv functions.</li>
<li><b>failed loading Pru_Run instructions</b>: The driver couldn't load the instructions to the PRU subsystem -&gt; check libprussdrv functions.</li>
<li><b>failed executing Pru_Run instructions</b>: The driver couldn't initialize the devices -&gt; ADC device may be broken or other software uses the same PRU subsystem.</li>
</ul>
<h2><a class="anchor" id="SubErrSet"></a>
gpio_set Errors  </h2>
<ul>
<li><b>unknown pin number</b>: The ball index is too big -&gt; pass a correct ball index in parameter <em>Ball</em>.</li>
<li><b>pin locked</b>: New setting is forbidden since the ball is locked -&gt; check ball number (or call this function with a proper setting for parameter <em>Lokk</em>).</li>
</ul>
<h2><a class="anchor" id="SubErrGet"></a>
gpio_get Error  </h2>
<ul>
<li><b>unknown pin number</b>: The ball index is too big -&gt; pass a correct ball index in parameter <em>Ball</em>.</li>
</ul>
<h2><a class="anchor" id="SubErrOut"></a>
gpio_out Errors  </h2>
<ul>
<li><b>unknown output pin number</b>: The ball index is too big -&gt; pass a correct ball index in parameter <em>Ball</em>.</li>
<li><b>input pin</b>: You tried to set the state of an input CPU ball -&gt; check ball number (or call function <a class="el" href="structPruIo.html#aedfa737c300263c1b4d13df18ade6071">PruIo::gpio_set()</a> with proper setting for parameter <em>Modus</em> first).</li>
<li><b>output pin locked</b>: Setting a new state is forbidden since the ball is locked -&gt; check ball number (or call function <a class="el" href="structPruIo.html#aedfa737c300263c1b4d13df18ade6071">PruIo::gpio_set()</a> with proper setting for parameter <em>Lokk</em> first).</li>
</ul>
<h2><a class="anchor" id="SubErrGetConf"></a>
gpio_get_config Error  </h2>
<ul>
<li><b>unknown pin number</b>: The ball index is too big -&gt; pass a correct ball index in parameter <em>Ball</em>.</li>
</ul>
<h2><a class="anchor" id="SubErrStep"></a>
adc_step Errors  </h2>
<ul>
<li><b>step number too big</b>: The step index is too big -&gt; pass a correct step index in parameter <em>Stp</em> (0 = charge step, 1 to 16 = ADC steps, 17 = idle step).</li>
<li><b>channel number too big</b>: The channel index is too big -&gt; pass a correct channel index in parameter <em>ChN</em> (0 = AIN0, 1 = AIN1, ..., 7 = AIN7).</li>
</ul>
<h2><a class="anchor" id="SubErrPin"></a>
mm_trg_pin Errors  </h2>
<ul>
<li><b>unknown trigger pin number</b>: The ball index is too big -&gt; pass a correct ball index in parameter <em>Ball</em>.</li>
<li><b>pin must be in GPIO mode (mode 7)</b>: The specified CPU ball is not in mode 7 (GPIO) -&gt; check ball number (or call function <a class="el" href="structPruIo.html#aedfa737c300263c1b4d13df18ade6071">PruIo::gpio_set()</a> with proper setting for parameter <em>Modus</em> first).</li>
<li><b>too much values to skip</b>: The delay time is too big, this means too much samples to skip -&gt; set parameter <em>Skip</em> with proper (lower) value (it's limited to the range of 0 to 1023). If you still need a longer waiting time, consider to increase the parameter <em>Tmr</em> for the next call to function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a>.</li>
</ul>
<h2><a class="anchor" id="SubErrAin"></a>
mm_trg_ain Errors  </h2>
<ul>
<li><b>invalid step number</b>: The specified index for the trigger step is too big -&gt; choose a step index in the range 1 to 16.</li>
<li><b>trigger step not configured</b>: The specified trigger step is not configured -&gt; either recreate the trigger specification or call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again and active the trigger step in parameter <em>Mask</em>.</li>
<li><b>too much values to skip</b>: The delay time is too big, this means too much samples to skip -&gt; set parameter <em>Skip</em> with proper (lower) value (it's limited to the range of 0 to 1023). If you still need a longer waiting time, consider to increase the parameter <em>Tmr</em> for the next call to function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a>.</li>
</ul>
<h2><a class="anchor" id="SubErrPre"></a>
mm_trg_pre Errors  </h2>
<ul>
<li><b>invalid step number</b>: The specified index for the trigger step is too big -&gt; choose a step index in the range 0 to 16.</li>
<li><b>trigger step not configured</b>: The specified trigger step is not configured -&gt; either recreate the trigger specification or call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again and active the trigger step in parameter <em>Mask</em>.</li>
<li><b>trigger step not activated</b>: The trigger specification contains a trigger step that is not active in the <a class="el" href="structPruIo.html#a28eda7e2d4eacbb6bb9368b9c444b008">PruIo::StepMask</a> -&gt; either recreate the trigger specification or call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again and active the trigger step in parameter <em>Mask</em>.</li>
<li><b>too much pre-samples</b>: There is not enough memory to sort the pre-trigger samples -&gt; call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again and either reduce parameter <em>Samp</em> or choose less active steps in parameter <em>Mask</em>.</li>
<li><b>more pre-samples than samples</b>: There are less samples than pre-trigger samples -&gt; either reduce parameter <em>Samp</em> or call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again with increased parameter <em>Samp</em>.</li>
</ul>
<h2><a class="anchor" id="SubErrStart"></a>
mm_start Errors  </h2>
<ul>
<li><b>Trg#: unknown trigger pin number</b>: A digital trigger specifies a CPU ball number greater than the maximum -&gt; check the trigger specification.</li>
<li><b>Trg#: trigger pin must be in mode 7 (GPIO)</b>: A digital trigger specifies a CPU ball number that is not in GPIO mode -&gt; check ball number, set CPU ball in mode 7.</li>
<li><b>Trg#: too much pre-trigger samples</b>: There's not enough memory to sort the pre-trigger ring buffer -&gt; call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again and reduce either parameter <em>Samp</em> or the number of active steps parameter <em>Mask</em>.</li>
<li><b>Trg#: pre-trigger step must be active</b>: The pre-trigger specifies a step that isn't active in the <a class="el" href="structPruIo.html#a28eda7e2d4eacbb6bb9368b9c444b008">PruIo::StepMask</a> -&gt; either re-create the trigger specification or call function <a class="el" href="structPruIo.html#aad8898bd8a39bd0d043f03b82f76ba05">PruIo::config()</a> again with proper active steps parameter <em>Mask</em></li>
</ul>
<h2><a class="anchor" id="SubErrDtor"></a>
Destructor Errors  </h2>
<p>Destructor error messages cannot get passed in the <a class="el" href="structPruIo.html#a04215cd3faee95feac7af13ebeee0698">PruIo::Errr</a> variable (since this variable is invalid when the destructor returns). These error messages get printed to the STDERR pipe directly.</p>
<ul>
<li><b>failed loading Pru_Exit instructions</b>: The driver couldn't load the exit instructions to the PRU subsystem -&gt; test function of prussdrv library.</li>
<li><b>failed executing Pru_Exit instructions</b>: Executing the exit instructions failed -&gt; check if other software uses this PRU. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Jun 6 2014 13:22:55 for libpruio by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.4 </li>
  </ul>
</div>
</body>
</html>
